/**
 * Alopex Grid Search Plugin v1.0.2
 * http://grid.alopex.io
 *
 * Copyright (c) 2018 SK Holdings C&C. All rights reserved.
 * 
 * This software is the confidential and proprietary information of SK Holdings C&C.
 * You shall not disclose such confidential information and shall use it only in
 * accordance with the terms of the license agreement you entered into with SK Holdings C&C.
 *
 * Date : 2019-02-14 10:02:20 GMT+0900 (대한민국 표준시)
 **/
!function(e){function r(){!0===o.debug&&(a?console.error?console.error($.makeArray(arguments).join(" ")):console.log($.makeArray(arguments).join(" ")):console.error?console.error.apply(console,arguments):console.log.apply(console,arguments))}function i(e){return!(!e||!(e.nodeType||e.jquery&&e.length))}var t=null;if(e.AlopexGrid&&e.AlopexGrid.release?t=e.AlopexGrid:e[e.__AlopexGridExportName__]&&e[e.__AlopexGridExportName__].release&&(t=e[e.__AlopexGridExportName__]),!(t&&function(e,r){var i,t,o=/(\.0+)+$/,a=e.replace(o,"").split("."),n=r.replace(o,"").split("."),s=Math.min(a.length,n.length);for(i=0;i<s;i++)if(t=parseInt(a[i],10)-parseInt(n[i],10))return t;return a.length-n.length}(t.release,"3.9.0")>=0))return void console.error("AlopexGrid Search plugin needs AlopexGrid above version 3.9.0.");var o=function(){var r=this;if(this===e||null==this||this===t.plugin)if("function"==typeof Object.create)r=Object.create(o.prototype);else{var i=function(){};i.prototype=o.prototype,r=new i,i.prototype=null}return r.$grid=null,r.$searchWidget=null,r.widgetMarkup='<div class="alopexgrid-search-plugin-section"><input type="text" name="alopexgrid_search_keyword" class="alopexgrid-search-plugin-keyword"><span class="alopexgrid-search-plugin-result"></span></div><div class="alopexgrid-search-plugin-section"><button type="button" class="alopexgrid-search-plugin-search">'+AlopexGrid.i18n("search")+'</button><button type="button" class="alopexgrid-search-plugin-prev"></button><button type="button" class="alopexgrid-search-plugin-next"></button></div>',r.delay=500,r.resultRenderer=function(e,r){return e+" / "+r},r.searchOption={},r};o.release="1.0.2",o.version=o.release.split(".")[0];var a=!1;console.log.apply&&console.error.apply||(a=!0),o.prototype.setGrid=function(e){(i(e)||"string"==typeof e)&&(this.$grid=$(e))},o.prototype.setSearchWidget=function(e){if(i(e)||"string"==typeof e){var r=$(e);r.length&&(this.$searchWidget=r.addClass("alopexgrid-search-plugin").html(this.widgetMarkup))}},o.prototype.setSearchOption=function(e,r){if(e&&$.isPlainObject(e))for(var i in e)e.hasOwnProperty(i)&&(this.searchOption[i]=e[i]);else"string"==typeof e&&void 0!==r&&(this.searchOption[e]=r)},o.prototype.setSearchResult=function(e){var r=this;if(e&&$.isPlainObject(e)){var i=e.matchCount||0,t=i?Math.min(i,e.highlightPointer+1):0;r.$searchWidget.find(".alopexgrid-search-plugin-result").text(r.resultRenderer(t,i))}else r.$searchWidget.find(".alopexgrid-search-plugin-result").text("")},o.prototype.getUserKeyword=function(){return this.$searchWidget.find(".alopexgrid-search-plugin-keyword").val()},o.prototype.searchWithKeyword=function(e,r){var i=this,t=i.$grid.alopexGrid("pageInfo").current;if(e){var o=i.$grid.alopexGrid("searchInfo");if(i.searchKeyword==e&&o&&t===o.prevPage){var a=null;a=r?i.$grid.alopexGrid("searchPrevious"):i.$grid.alopexGrid("searchNext"),i.setSearchResult(a),!1===a&&(i.searchKeyword=null,e=i.getUserKeyword(),i.searchWithKeyword(e,r))}else i.searchKeyword=e,1==i.searchOption.showProgress?i.$grid.alopexGrid("startSearch",e,i.searchOption,function(){i.setSearchResult(i.$grid.alopexGrid("searchInfo"))}):i.setSearchResult(i.$grid.alopexGrid("startSearch",e,i.searchOption))}else{i.setSearchResult(i.$grid.alopexGrid("endSearch")),i.searchKeyword=null;i.$grid.__alopexgrid().state.alreadyUseFiltered=!1}},o.prototype.init=function(){var e=this;return e.$searchWidget&&e.$searchWidget.get(0)?e.$grid&&e.$grid.get(0)?(e.$searchWidget.off(".alopexGridSearchPlugin").on("click.alopexGridSearchPlugin",".alopexgrid-search-plugin-search",function(r){var i=e.getUserKeyword();e.searchWithKeyword(i,r.shiftKey)}).on("click.alopexGridSearchPlugin",".alopexgrid-search-plugin-prev",function(r){e.setSearchResult(e.getUserKeyword()==e.searchKeyword?e.$grid.alopexGrid("searchPrevious"):null)}).on("click.alopexGridSearchPlugin",".alopexgrid-search-plugin-next",function(r){e.setSearchResult(e.getUserKeyword()==e.searchKeyword?e.$grid.alopexGrid("searchNext"):null)}).on("keypress.alopexGridSearchPlugin",".alopexgrid-search-plugin-keyword",function(r){if(13==r.which){var i=e.getUserKeyword();e.searchWithKeyword(i,r.shiftKey)}}).on("click.alopexGridSearchPlugin",".alopexgrid-search-plugin-result",function(r){e.$searchWidget.find(".alopexgrid-search-plugin-keyword").focus()}),void e.$searchWidget.find(".alopexgrid-search-plugin-keyword").keypress()):(r("Search init failed - no grid set."),!1):(r("Search init failed - no search widget set."),!1)},o.prototype.getSearchResult=function(){var e=this.$grid.alopexGrid("searchInfo");return e&&e.matchDataList?[].concat(e.matchDataList):null},t.plugin.Search=o}(window);